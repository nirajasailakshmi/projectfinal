
2.a select count(worksite) as cwork, year from h1b_final where job_title='%Data Engineer%' group by worksite,year order by year,cwork desc limit 1; 

b.

create table y11(location string,year int,case_status string) row format delimited fields terminated by ',';

create table y12(location string,year int,case_status string) row format delimited fields terminated by ',';

create table y13(location string,year int,case_status string) row format delimited fields terminated by ',';

create table y14(location string,year int,case_status string) row format delimited fields terminated by ',';

create table y15(location string,year int,case_status string) row format delimited fields terminated by ',';

create table y16(location string,year int,case_status string) row format delimited fields terminated by ',';

insert into table y11 select count(worksite) as cwork,year,job_title from h1b_final where case_status ='CERTIFIED' and year= '2011' group by job_title,year order by cwork desc limit 5;

insert into table y12 select count(worksite) as cwork,year,job_title from h1b_final where case_status ='CERTIFIED' and year= '2012' group by job_title,year order by cwork desc limit 5;

insert into table y13 select count(worksite) as cwork,year,job_title from h1b_final where case_status ='CERTIFIED' and year= '2013' group by job_title,year order by cwork desc limit 5;

insert into table y14 select count(worksite) as cwork,year,job_title from h1b_final where case_status ='CERTIFIED' and year= '2014' group by job_title,year order by cwork desc limit 5;

insert into table y15 select count(worksite) as cwork,year,job_title from h1b_final where case_status ='CERTIFIED' and year= '2015' group by job_title,year order by cwork desc limit 5;

insert into table y16 select count(worksite) as cwork,year,job_title from h1b_final where case_status ='CERTIFIED' and year= '2016' group by job_title,year order by cwork desc limit 5;

select * from y11 union all select * from y12 union all select * from y13 union all select * from y14 union all select * from y15 union all select * from y16 order by year;

3.select soc_name ,count(soc_name) as soc_count from h1b_final where job_title like '%Data Scientists%' group by soc_name order by soc_count desc limit 1;

4.create table y21(ename string,year int,c_status string) row format delimited fields terminated by ',';

create table y22(ename string,year int,c_status string) row format delimited fields terminated by ',';

create table y23(ename string,year int,c_status string) row format delimited fields terminated by ',';

create table y24(ename string,year int,c_status string) row format delimited fields terminated by ',';

create table y25(ename string,year int,c_status string) row format delimited fields terminated by ',';

create table y26(ename string,year int,c_status string) row format delimited fields terminated by ',';


insert into table y21 select employer_name,count(year) as cyear,case_status from h1b_final where year= '2011' group by employer_name,case_status order by cyear desc limit 5;

insert into table y22 select employer_name,count(year) as cyear,case_status from h1b_final where year= '2012' group by employer_name,case_status order by cyear desc limit 5;

insert into table y23 select employer_name,count(year) as cyear,case_status from h1b_final where year= '2013' group by employer_name,case_status order by cyear desc limit 5;

insert into table y24 select employer_name,count(year) as cyear,case_status from h1b_final where year= '2014' group by employer_name,case_status order by cyear desc limit 5;

insert into table y25 select employer_name,count(year) as cyear,case_status from h1b_final where year= '2015' group by employer_name,case_status order by cyear desc limit 5;

insert into table y26 select employer_name,count(year) as cyear,case_status from h1b_final where year= '2016' group by employer_name,case_status order by cyear desc limit 5;

select * from y21 union all select * from y22 union all select * from y23 union all select * from y24 union all select * from y25 union all select * from y26 order by year;




5.a.

create table year21(jobs string,year int,case_status string) row format delimited fields terminated by ',';

create table year22(jobs string,year int,case_status string) row format delimited fields terminated by ',';

create table year23(jobs string,year int,case_status string) row format delimited fields terminated by ',';

create table year24(jobs string,year int,case_status string) row format delimited fields terminated by ',';

create table year25(jobs string,year int,case_status string) row format delimited fields terminated by ',';

create table year26(jobs string,year int,case_status string) row format delimited fields terminated by ',';

insert into table year21 select count(job_title) as cjob,year,job_title from h1b_final where year= '2011' group by job_title,year order by cjob desc limit 10;

insert into table year22 select count(job_title) as cjob,year,job_title from h1b_final where year= '2012' group by job_title,year order by cjob desc limit 10;

insert into table year23 select count(job_title) as cjob,year,job_title from h1b_final where year= '2013' group by job_title,year order by cjob desc limit 10;

insert into table year24 select count(job_title) as cjob,year,job_title from h1b_final where year= '2014' group by job_title,year order by cjob desc limit 10;

insert into table year25 select count(job_title) as cjob,year,job_title from h1b_final where year= '2015' group by job_title,year order by cjob desc limit 10;

insert into table year26 select count(job_title) as cjob,year,job_title from h1b_final where year= '2016' group by job_title,year order by cjob desc limit 10;

select * from year11 union all select * from year12 union all select * from year13 union all select * from year14 union all select * from year15 union all select * from year16 order by year;


b.create table year11(jobs string,year int,case_status string) row format delimited fields terminated by ',';

create table year12(jobs string,year int,case_status string) row format delimited fields terminated by ',';

create table year13(jobs string,year int,case_status string) row format delimited fields terminated by ',';

create table year14(jobs string,year int,case_status string) row format delimited fields terminated by ',';

create table year15(jobs string,year int,case_status string) row format delimited fields terminated by ',';

create table year16(jobs string,year int,case_status string) row format delimited fields terminated by ',';

insert into table year11 select count(job_title) as cjob,year,job_title from h1b_final where case_status ='CERTIFIED' and year= '2011' group by job_title,year order by cjob desc limit 10;

insert into table year12 select count(job_title) as cjob,year,job_title from h1b_final where case_status ='CERTIFIED' and year= '2012' group by job_title,year order by cjob desc limit 10;

insert into table year13 select count(job_title) as cjob,year,job_title from h1b_final where case_status ='CERTIFIED' and year= '2013' group by job_title,year order by cjob desc limit 10;

insert into table year14 select count(job_title) as cjob,year,job_title from h1b_final where case_status ='CERTIFIED' and year= '2014' group by job_title,year order by cjob desc limit 10;

insert into table year15 select count(job_title) as cjob,year,job_title from h1b_final where case_status ='CERTIFIED' and year= '2015' group by job_title,year order by cjob desc limit 10;

insert into table year16 select count(job_title) as cjob,year,job_title from h1b_final where case_status ='CERTIFIED' and year= '2016' group by job_title,year order by cjob desc limit 10;

select * from year11 union all select * from year12 union all select * from year13 union all select * from year14 union all select * from year15 union all select * from year16 order by year;

8.select year,job_title,AVG(prevailing_wage) as average from h1b_final where full_time_position='Y' and prevailing_wage is not null group by job_title,year order by average desc;

select year,job_title,AVG(prevailing_wage) as average from h1b_final where full_time_position='N' and prevailing_wage is not null group by job_title,year order by average desc;










